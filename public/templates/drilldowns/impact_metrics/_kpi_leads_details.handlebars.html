
<div class="arrow"></div>
<div class="drilldown_content">
		<div id="kpi_environment_detail" class="object_detail">
			<span class="dismiss"><i class="fa fa-times"></i></span>
			<div class="object_detail_content">
				<div class="object_detail_content_section summary">
					<h4>Current Progress</h4>
              		<span class="subtext">Snapshot of how your team is performing in this month</span>

                	<div class="contributor">
	                  	<div class="info-box">
	                    	<div id="avatar1" class="avatar"></div>
							<div class="info-text">
								<a id="hover1"><span>Jon Doe</span></a>
								<br> 
								<span class="light-text">24 Quotes, 17 Sales</span>
							</div>
	                 	</div>
	                </div>

                	<div class="contributor">
	                  	<div class="info-box">
	                    	<div id="avatar2" class="avatar"></div>
							<div class="info-text">
								<a id="hover1"><span>Sam Smith</span></a>
								<br> 
								<span class="light-text">13 Quotes, 5 Sales</span>
							</div>
	                 	</div>
	                </div>

                	<div class="contributor">
	                  	<div class="info-box">
	                    	<div id="avatar3" class="avatar"></div>
							<div class="info-text">
								<a id="hover1"><span>Lisa Williams</span></a>
								<br> 
								<span class="light-text">10 Quotes, 2 Sales</span>
							</div>
	                 	</div>
	                </div>

				</div>


				<div class="object_detail_content_section" style="padding-left:20px;">
					<h4 id="graph_title">Full Genealogy Conversion History</h4>
					<canvas id="metricsChart" width="670" height="375" style="float:left;"></canvas>
					<div style="width:150px; padding-left:50px;float:left;">
						<br><br>
		                <div class="legend">
		                  <div class="legend-item" id="user-legend"></div>
		                  <span id="selected_user" class="legend-text">Quotes</span>
		                </div>
		                <br>
		                <div class="legend">
		                  <div class="legend-item" id="global-legend"></div>
		                  <span id="average" class="legend-text">Sales</span>
		                </div>
		                <br>
		                <div class="legend hide">
		                  <div class="legend-item" id="top-performer"></div>
		                  <span id="performer" class="legend-text"></span>
		                </div>

		                <br>


					</div>
				</div>

			</div>
		</div>
</div>


<style>


  .avatar {
    width:70px;
    height:70px;
    -moz-border-radius:50%;
    -webkit-border-radius:50%;
    border-radius:50%;
    background-size:contain;
    float:left;
  }

  #avatar1 {
    background-image: url('https://avatars0.githubusercontent.com/u/5414273?v=3&s=460');
  }

  #avatar2 {
    background-image: url('https://avatars2.githubusercontent.com/u/8699048?v=3&s=460')
  }

  #avatar3 {
    background-image: url('https://avatars1.githubusercontent.com/u/5241140?v=3&s=460')
  }

  .subtext {
    font-size:0.8em;
  }

  .info-box {
    display:inline-block;
    padding-top:10px;
  }

  .info-text {
    padding:2.5px 0 0 21px;
    float:left;
  }

  .light-text {
    color:#eee;
    font-size:0.85em;
  }

	.legend-box {
    vertical-align:top;
    display:inline-block;
  }

  .legend {
    display;inline;
  }

  .legend-item {
    width:25px;height:20px;
    float:left;
    margin-top:5px;
  }

  .legend-text {
    font-size:0.8em;
    float:left;
    padding-left:5px;
  }
  #user-legend {
    background-color:rgba(32,194,241,1);
  }

  #global-legend {
    background-color:rgba(249,166,0,1);
  }
  #top-performer{
    background-color: rgba(44,148,105,1);
  }
  .hide{
    display: none;
  }
h4{
	height: 42px;
}
.object_detail_content_section.summary{
	width: 280px;
	padding-right: 25px;
	border-right:1px solid rgba(100,100,100,0.9);

}
.object_detail_content_section{
	width:880px;
	float:left;
}
.graph {
	width: 1180px;
	height: 300px;
	float: left;
	font-size: 14px;
	color: #fff;
	text-align: center;
	padding-top: 20px;
	margin-right:20px;
}

</style>
<script>
_randomData = {}
_randomData.me=[];
_randomData.team=[];
_randomData.performer=[];

for(i=1;i<=12;i++){
	_randomData.me.push(Math.floor(Math.random()*18+100));
	_randomData.team.push(Math.floor(Math.random()*18+100));
	_randomData.performer.push(0);
}

var topPerformers=[];
["John Doe", "Danny Smith", "Lisa Williams"].forEach(function(name){
  var tempData1 =[];
  var tempData2 =[];

  for(i=0;i<12;i++) tempData1.push(Math.floor(Math.random()*10+10));
  for(i=0;i<12;i++) tempData2.push(Math.floor(Math.random()*10+10));

  topPerformers.push({
    name:name,
    data1:tempData1,
    data2:tempData2
  });
});

var metricsData = {
    labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
    datasets: [
        {
            label: "My First dataset",
            fillColor: "#20c2f1",
            highlightFill: "#5bd7f7",
            data: _randomData.me
        },
        {
            label: "My Second dataset",
            fillColor: "#FDB45C",
            highlightFill: "#FFC870",
            data: _randomData.team
        }
    ]
};
var ctx = document.getElementById("metricsChart").getContext("2d");

var options={

    //Boolean - Whether the scale should start at zero, or an order of magnitude down from the lowest value
    scaleBeginAtZero : true,

    //Boolean - Whether grid lines are shown across the chart
    scaleShowGridLines : true,

    //String - Colour of the grid lines
    scaleGridLineColor : "rgba(255,255,255,.15)",
    scaleFontColor:"#fff",

    //Number - Width of the grid lines
    scaleGridLineWidth : 1,

    //Boolean - If there is a stroke on each bar
    barShowStroke : true,

    //Number - Pixel width of the bar stroke
    barStrokeWidth : 2,

    //Number - Spacing between each of the X value sets
    barValueSpacing : 5,

    //Number - Spacing between data sets within X values
    barDatasetSpacing : 1,

    //String - A legend template
    legendTemplate : "<ul class=\"<%=name.toLowerCase()%>-legend\"><% for (var i=0; i<datasets.length; i++){%><li><span style=\"background-color:<%=datasets[i].lineColor%>\"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>"

}

var myChart = new Chart(ctx).Bar(metricsData, options);  

$(".contributor")
    .velocity("transition.slideUpBigIn", { 
      stagger: 200, 
      duration: 600
    })
    .append("<hr style='border-color:rgba(255,255,255,.08);margin:5px 0 5px 0'> ")


$(".contributor").on("click",function(e){
  
  e.preventDefault();
  e.stopPropagation();
  _index=$(this).find(".avatar").attr("id").replace("avatar","")-1;
  $.extend(metricsData.datasets[0].data, topPerformers[_index].data1);
  $.extend(metricsData.datasets[1].data, topPerformers[_index].data2);

  // metricsData.datasets[2].fillColor = "rgba(44,148,105,1)";
  // metricsData.datasets[2].highlightFill= "rgba(44,148,105,1)";


  options.animationSteps=5;
  myChart.destroy();
  myChart = new Chart(ctx).Bar(metricsData, options);  
  $("#graph_title").html(topPerformers[_index].name+"'s Conversion History")
  // $("#performer").html(topPerformers[_index].name);
  // $(".legend").removeClass("hide");

});

function numberWithCommas(x) {
    return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
}
</script>